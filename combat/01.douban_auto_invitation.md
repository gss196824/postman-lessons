### 需求

```diff
有一天正当我酣畅淋漓在召唤师峡谷游荡时，一个消息打断了我的喜悦。

+她：在吗？我要出租房子。能帮我在dou瓣上发下帖吗？我的号被删了。

我秉承着妇女之友的美称，果断回了个:小事情，到时候搬家我需要帮你搬吗？

+她：不用了，我男朋友帮我搬。

-我：。。。

```

### 需求转化实现
---
由于dou瓣小组采用了，最新回复的帖子，会被置顶到最前面。所以我们需要不断的去顶贴顶贴。以保证我们的曝光量足够大，从而达成出租房子的目的。

> 作为测试工程师，我们有天生的自动化属性，所以很轻松就能将不断顶贴的操作转为自动化来实现。从而节约的时间我们才能回到召唤师峡谷

下面列出我们手工的操作步骤：

- 搜索dou瓣->登陆->点击小组->找到对应的帖子->回复

如果我们使用selenium的话就需要按照上面的方式来写脚本。

先别慌动手，我们再来看看通过接口的方式需要几个步骤：

- 登陆接口(保存cookie)-> 评论接口

这就是接口的魅力。那么我们动手来实现一下

--- 

### 准备接口

> 我们使用Charles已经获取了我们需要的接口

#### 登陆接口
> https://accounts.douban.com/j/mobile/login/basic
- 请求参数
    * name  (豆瓣账号)
    - password (豆瓣密码)
    - remember (是否记住)
    - ticket
    - ck

如图所示： 

![postman登陆示意图](https://s1.ax1x.com/2020/05/29/tKnUeJ.png)

#### 评论接口

> https://www.douban.com/group/topic/176090092/add_comment
- headers 请求参数
    - Cookie (从登陆请求响应中可得到)
- Body 请求内容
    - ck
    - rv_comment (评论内容)

如图所示:    

![postman评论接口示意图](https://s1.ax1x.com/2020/05/29/tKnaw9.png)
### 实现
--- 

#### 发送登陆接口

> 通过上面提到的接口再带上参数，就能请求成功。

#### 记录Cookie
> Cookie技术通过在请求和响应报文中写入Cookie信息来控制客户端的状态。Cookie会根据从服务器端发送的响应报文内的一个叫做Set-Cookie的首部字段信息，通知客户端保存Cookie。当下次客户端再往该服务器发送请求时，客户端会自动在请求报文中加入Cookie值后发送出去

- 通过登陆接口拿到响应值中的Set-Cookie将它的值复制，粘贴到我们下一个评论接口中。

#### 发送评论接口

带上登陆接口返回的cookie值，以及rv_comment(评论内容)。一次豆瓣顶帖大功告成。